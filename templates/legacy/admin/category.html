{{define "content"}}
<table width="100%" cellpadding="0" cellspacing="0" border="0" style="margin-bottom: 20px;">
  <tr>
    <td>
      <p style="margin: 0 0 10px 0;"><a href="/admin">← Back to dashboard</a></p>
      <h1 class="header-green">{{if .Category.ID}}Edit Poll{{else}}New Poll{{end}}</h1>
      {{if .Category.ID}}
      <p class="muted-text" style="margin: 5px 0 0 0;">
        ID: {{.Category.ID}} ·
        {{if eq .Category.Status "draft"}}
        <span class="badge-draft">DRAFT</span>
        {{else if eq .Category.Status "open"}}
        <span class="badge-open">OPEN</span>
        {{else if eq .Category.Status "closed"}}
        <span class="badge-closed">CLOSED</span>
        {{else if eq .Category.Status "archived"}}
        <span class="badge-archived">ARCHIVED</span>
        {{end}}
      </p>
      {{end}}
    </td>
  </tr>
</table>

{{if .Error}}
<p class="error">{{.Error}}</p>
{{end}}

{{if .Success}}
<p class="success">{{.Success}}</p>
{{end}}

<form method="POST" action="{{if .Category.ID}}/admin/category/{{.Category.ID}}{{else}}/admin/category/new{{end}}">
  <table width="100%" cellpadding="0" cellspacing="0" border="0" style="margin-bottom: 20px;">
    <tr>
      <td width="120"><b>Poll Name:</b></td>
      <td>
        <input type="text" name="name" value="{{.Category.Name}}" size="50" class="form-input">
      </td>
    </tr>
  </table>

  <p><b>Vote Type:</b></p>
  <p class="option-box">
    <input type="radio" name="vote_type" value="single" id="type_single" {{if eq .Category.VoteType "single"}}checked{{end}}>
    <label for="type_single">Single Choice</label> - Voters select one option
  </p>
  <p class="option-box">
    <input type="radio" name="vote_type" value="approval" id="type_approval" {{if eq .Category.VoteType "approval"}}checked{{end}}>
    <label for="type_approval">Approval Voting</label> - Voters can select multiple options
  </p>
  <p class="option-box">
    <input type="radio" name="vote_type" value="ranked" id="type_ranked" {{if eq .Category.VoteType "ranked"}}checked{{end}}>
    <label for="type_ranked">Ranked Choice</label> - Voters rank their top 3 choices
  </p>

  <p style="margin-top: 20px;">
    <input type="submit" value="{{if .Category.ID}}Save Changes{{else}}Create Poll{{end}}" class="btn">
  </p>
</form>

{{if .Category.ID}}
<hr style="margin: 30px 0; border: none; border-top: 1px solid #404040;">

<h2 class="header-green">Options</h2>

{{if .Options}}
<table class="data" style="margin-bottom: 20px;">
  <tr>
    <th width="40">ID</th>
    <th>Option Name</th>
    <th width="80">Action</th>
  </tr>
  {{range .Options}}
  <tr>
    <td>{{.ID}}</td>
    <td>{{.Name}}</td>
    <td align="center">
      <form method="POST" action="/admin/category/{{$.Category.ID}}/option/{{.ID}}/remove" style="display:inline;">
        <input type="submit" value="Remove" class="btn-red">
      </form>
    </td>
  </tr>
  {{end}}
</table>
{{else}}
<p style="color: #999;">No options yet. Add some below.</p>
{{end}}

<form method="POST" action="/admin/category/{{.Category.ID}}/option/add">
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
    <tr>
      <td width="120"><b>Add Option:</b></td>
      <td>
        <input type="text" name="name" placeholder="Option name..." size="40" style="padding: 8px; border: 1px solid #404040; width: 300px; background-color: #0a0a0a; color: #f5f5f5;">
      </td>
      <td width="100">
        <input type="submit" value="Add" class="btn" style="padding: 8px 16px;">
      </td>
    </tr>
  </table>
</form>
{{end}}
{{end}}
