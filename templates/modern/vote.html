{{define "content"}}
<div class="max-w-lg mx-auto space-y-8">
    <!-- Header -->
    <header>
        <a href="/" class="text-neutral-500 text-xs hover:text-neutral-300 mb-4 inline-block">
            ← Back
        </a>
        <h1 class="font-arcade text-lg text-arcade-amber glow-amber">
            {{.Category.Name}}
        </h1>
        <p class="text-neutral-500 text-sm mt-2">
            {{if eq .Category.VoteType "single"}}Select one option
            {{else if eq .Category.VoteType "approval"}}Select all that apply
            {{else if eq .Category.VoteType "ranked"}}Rank your top {{.MaxRank}} choices
            {{end}}
        </p>
    </header>

    <div id="vote-form" class="arcade-border bg-arcade-panel p-6">
        {{template "vote-form-content" .}}
    </div>
</div>
{{end}}

{{define "vote-form-content"}}
{{if .Success}}
<!-- Success state -->
<div class="text-center py-8 space-y-6">
    <div class="w-16 h-16 bg-arcade-green/10 border-2 border-arcade-green rounded-full flex items-center justify-center mx-auto">
        <span class="text-arcade-green text-2xl" aria-hidden="true">✓</span>
    </div>
    <div>
        <h2 class="font-arcade text-lg text-arcade-green glow-green mb-2">
            VOTE RECORDED!
        </h2>
        <p class="text-neutral-400">
            Thank you for voting
        </p>
    </div>
    <a href="/" class="text-neutral-500 hover:text-neutral-300 text-sm transition-colors inline-block">
        ← Back to all votes
    </a>
</div>
{{else}}
<!-- Vote form -->
{{if .Error}}
<div class="bg-arcade-red/10 border border-arcade-red/30 text-arcade-red px-4 py-3 rounded mb-6">
    {{.Error}}
</div>
{{end}}

<form method="POST" action="/vote/{{.Category.ID}}"
      hx-post="/vote/{{.Category.ID}}"
      hx-target="#vote-form"
      hx-swap="innerHTML"
      class="space-y-6">

    <!-- Nickname input -->
    <div>
        <label class="block text-xs text-neutral-400 mb-2 uppercase tracking-wide">
            Your Nickname
        </label>
        <input type="text" name="nickname" value="{{.Nickname}}"
               placeholder="Enter nickname..."
               class="input-arcade">
    </div>

    <!-- Vote options -->
    <div>
        <label class="block text-xs text-neutral-400 mb-3 uppercase tracking-wide">
            Make your selection
        </label>

        {{if eq .Category.VoteType "single"}}
        <!-- Single choice (radio) -->
        <div class="space-y-2">
            {{range .Options}}
            <label class="flex items-center gap-3 p-3 rounded border border-arcade-border hover:border-neutral-600 hover:bg-neutral-800/50 focus-within:border-arcade-green cursor-pointer transition-all">
                <input type="radio" name="choice" value="{{.ID}}" class="w-4 h-4">
                <span class="text-neutral-300">{{.Name}}</span>
            </label>
            {{end}}
        </div>

        {{else if eq .Category.VoteType "approval"}}
        <!-- Approval (checkboxes) -->
        <div class="space-y-2">
            {{range .Options}}
            <label class="flex items-center gap-3 p-3 rounded border border-arcade-border hover:border-neutral-600 hover:bg-neutral-800/50 focus-within:border-arcade-green cursor-pointer transition-all">
                <input type="checkbox" name="choice" value="{{.ID}}" class="w-4 h-4">
                <span class="text-neutral-300">{{.Name}}</span>
            </label>
            {{end}}
        </div>

        {{else if eq .Category.VoteType "ranked"}}
        <!-- Ranked (dropdowns) -->
        <div class="space-y-3">
            {{range $i, $e := .Ranks}}
            {{$rank := add $i 1}}
            <div class="flex items-center gap-3">
                <span class="w-8 h-8 bg-arcade-amber/10 border border-arcade-amber/30 rounded flex items-center justify-center text-arcade-amber text-xs font-medium">
                    #{{$rank}}
                </span>
                <select name="rank{{$rank}}" class="select-arcade flex-1">
                    <option value="">Select choice #{{$rank}}</option>
                    {{range $.Options}}
                    <option value="{{.ID}}">{{.Name}}</option>
                    {{end}}
                </select>
            </div>
            {{end}}
        </div>
        {{end}}
    </div>

    <!-- Submit button -->
    <button type="submit"
            class="w-full bg-arcade-green hover:bg-green-400 text-arcade-dark font-medium py-3 rounded transition-colors btn-arcade arcade-border">
        SUBMIT VOTE
    </button>
</form>
{{end}}
{{end}}
